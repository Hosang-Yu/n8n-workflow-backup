{"createdAt":"2025-06-18T07:35:02.850Z","updatedAt":"2025-09-16T00:05:40.853Z","id":"4nYBePGh3oMxitVI","name":"06.산업통상자원부","active":true,"isArchived":false,"nodes":[{"parameters":{"url":"https://www.motie.go.kr","sendHeaders":true,"headerParameters":{"parameters":[{"name":"cookie","value":"={{ $response.headers[\"set-cookie\"]}}"}]},"options":{"redirect":{"redirect":{"followRedirects":false}},"response":{"response":{"fullResponse":true,"neverError":true}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-2704,192],"id":"2c5b5f7b-ff5f-4d00-967c-bd55c472d1f8","name":"HTTP Request3","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.motie.go.kr/kor/article/ATCLc01b2801b","sendHeaders":true,"headerParameters":{"parameters":[{"name":"cookie","value":"={{ $json.cookie }}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-2336,192],"id":"9cc211ec-313f-45b6-b87f-d6c32a5abddf","name":"HTTP Request4"},{"parameters":{"jsCode":"return {cookie: $input.first().json.headers['set-cookie'][0]}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-2528,192],"id":"1ba73c40-db2f-47bc-8ea7-a7be3a86d728","name":"Code"},{"parameters":{"extractionValues":{"values":[{"key":"announcements","cssSelector":".board-tbl table tbody tr td:nth-child(6) a","returnValue":"attribute","attribute":"href","returnArray":true},{"key":"title","cssSelector":".board-tbl table tbody tr td:nth-child(2) a > i","returnArray":true},{"key":"date","cssSelector":".board-tbl table tr td:nth-child(4)","returnArray":true}]},"options":{"trimValues":true}},"name":"리스트 추출1","type":"n8n-nodes-base.htmlExtract","position":[-2128,192],"typeVersion":1,"id":"cc2805bc-1ce0-43b1-a4f9-79c1b44f9a92"},{"parameters":{"options":{"reset":"={{ $node[\"Loop Over Items\"].context[\"done\"] }}"}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[-1680,192],"id":"d591536e-3fe9-4a1c-920f-8ec0a5c9b8e4","name":"Loop Over Items"},{"parameters":{"url":"=https://www.motie.go.kr{{ $('Loop Over Items').item.json.announcement }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"cookie","value":"={{ $json.cookie }}"},{"name":"Accept","value":"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"},{"name":"Accept-Encoding","value":"gzip, deflate, br, zstd"}]},"options":{"timeout":60000}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-656,208],"id":"4e09d03b-742d-440f-a3da-f2afae59496e","name":"HTTP Request6"},{"parameters":{"url":"=https://www.motie.go.kr{{ $('Loop Over Items').item.json.announcement }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"cookie","value":"={{ $response.headers[\"set-cookie\"]}}"},{"name":"accept","value":"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"}]},"options":{"redirect":{"redirect":{"followRedirects":false}},"response":{"response":{"fullResponse":true,"neverError":true,"responseFormat":"file"}},"timeout":60000}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-1088,208],"id":"ffb1c648-6335-41e4-8e72-e8c5bf1f4e14","name":"HTTP Request7","onError":"continueRegularOutput"},{"parameters":{"jsCode":"return {cookie: $input.first().json.headers['set-cookie'][0]}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-864,208],"id":"830f773b-0517-474b-b8f9-ef216e305845","name":"Code1"},{"parameters":{"method":"POST","url":"http://192.168.10.133:8000/convert","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"parameterType":"formBinaryData","name":"file","inputDataFieldName":"data"}]},"options":{"allowUnauthorizedCerts":false,"redirect":{"redirect":{}}}},"id":"eb37b960-ec1c-4c18-8bcc-047b949d39bb","name":"Upload a file9","type":"n8n-nodes-base.httpRequest","position":[-448,208],"typeVersion":4.2,"onError":"continueRegularOutput"},{"parameters":{"method":"POST","url":"https://api.mistral.ai/v1/files","sendHeaders":true,"headerParameters":{"parameters":[{"name":"content-type","value":"application/octet-stream"},{"name":"Authorization","value":"Bearer  aJUugk77GjvB8L7smr5n11JlKLab1xE5"}]},"sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"name":"purpose","value":"ocr"},{"parameterType":"formBinaryData","name":"=file","inputDataFieldName":"data"}]},"options":{"allowUnauthorizedCerts":false}},"id":"f0131224-e1f7-4d35-81ea-06beb6c6dd66","name":"Upload a file1","type":"n8n-nodes-base.httpRequest","position":[-240,208],"typeVersion":4.2,"onError":"continueRegularOutput"},{"parameters":{"url":"=https://api.mistral.ai/v1/files/{{$json[\"id\"]}}/url","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer  aJUugk77GjvB8L7smr5n11JlKLab1xE5"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[0,208],"id":"aa021ded-c5e6-42eb-9401-c38b972c1f8f","name":"HTTP Request1","onError":"continueRegularOutput"},{"parameters":{"method":"POST","url":"https://api.mistral.ai/v1/ocr","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer  aJUugk77GjvB8L7smr5n11JlKLab1xE5"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"model\": \"mistral-ocr-latest\",\n  \"document\": {\n    \"type\": \"document_url\",\n    \"document_url\": \"{{ $json.url }}\"\n  },\n  \"include_image_base64\": true\n}","options":{"allowUnauthorizedCerts":false,"response":{"response":{"responseFormat":"json"}}}},"id":"3043a256-e173-4263-8a65-a5fa4fd1e2de","name":"do ocr1","type":"n8n-nodes-base.httpRequest","position":[192,208],"typeVersion":4.2,"onError":"continueRegularOutput"},{"parameters":{"jsCode":"const pages = $input.first().json.pages;\nlet combinedMarkdown = '';\n\nfor (const page of pages) {\n  combinedMarkdown += page.markdown + '\\n';  // 줄바꿈 포함해서 합치기\n}\n\n// 생성일자: KST 기준 현재 시각\nconst now = new Date();\nconst kst = new Date(now.getTime() + 9 * 60 * 60 * 1000);\n\nconst yyyy = kst.getFullYear();\nconst mm = String(kst.getMonth() + 1).padStart(2, '0');\nconst dd = String(kst.getDate()).padStart(2, '0');\nconst hh = String(kst.getHours()).padStart(2, '0');\nconst min = String(kst.getMinutes()).padStart(2, '0');\nconst ss = String(kst.getSeconds()).padStart(2, '0');\n\nconst formatted = `${yyyy}-${mm}-${dd} ${hh}:${min}:${ss}`;\n\n// 통합 결과 반환\nreturn [\n  {\n    json: {\n      combinedMarkdown,\n      creat_p_nttm: formatted,\n      created_ts: formatted,\n      fileName: $('HTTP Request6').item.binary?.data?.fileName || '이름없음'\n    }\n  }\n];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[384,208],"id":"8787eb66-8385-4aa7-8d07-2f825fcc6ebe","name":"Code23","onError":"continueRegularOutput"},{"parameters":{"promptType":"define","text":"={{ $json.combinedMarkdown }} \\n에서  \npblanc_nm(공고제목),  \njrsd_instt_nm(지역 혹은 사이트이름),  \nbsns_sumry_cn(공고요약),  \ntrget_nm(대상기업),  \nreqst_begin_end_de(공고 전체기간),  \nreqst_begin_dt(공고시작기간),  \nreqst_end_dt(공고마감기간),  \nreqst_mth_papers_cn(사업신청방법),  \nrefrnc_nm(문의처),  \nsubsidy_amount(지원금액),  \nself_contribution_rate(자부담률),  \nsupport_target(지원기업 예: 대기업,중소기업),  \nbonus_points_factors(가점요소),  \ntotal_budget(예산)  \n에 대한 정보를 알려줘.\n\n공고제목은 detail_part에서 처음 <p>를 제목으로 참고.\n\n1. reqst_begin_end_de 형식은 YYYYMMDD ~ YYYYMMDD입니다.  \n   → 이를 reqst_begin_dt, reqst_end_dt로 YYYY-MM-DD 형식으로 변환.\n\n2. 지역명은 아래 cityMap에서 value로 변환해 주세요.\n\ncityMap: {\n  \"서울\": \"서울특별시\",\n  \"부산\": \"부산광역시\",\n  \"대구\": \"대구광역시\",\n  \"인천\": \"인천광역시\",\n  \"광주\": \"광주광역시\",\n  \"대전\": \"대전광역시\",\n  \"울산\": \"울산광역시\",\n  \"세종\": \"세종특별자치시\",\n  \"경기\": \"경기도\",\n  \"강원\": \"강원도\",\n  \"충북\": \"충청북도\",\n  \"충남\": \"충청남도\",\n  \"전북\": \"전라북도\",\n  \"전남\": \"전라남도\",\n  \"경북\": \"경상북도\",\n  \"경남\": \"경상남도\",\n  \"제주\": \"제주특별자치도\",\n  \"전지역\": \"전지역\"\n}\n\ntrget_nm값은 단일값(중소기업, 대기업 등)만 사용.\n\nprint_flpth_nm: {{ $('HTTP Request7').item.json.headers.location }},  \nprint_file_nm: {{ $json.fileName }},  \ncreat_p_nttm: {{ $json.creat_p_nttm }},  \ncreated_ts: {{ $json.created_ts }},\n\ncreat_p_nttm, created_ts는 timestamp 형식으로  \nreqst_begin_dt 값으로 \"yyyy-mm-dd hh:mm:ss\" 형식.\n\n값이 없거나 찾을 수 없으면 아래처럼 공백(\"\") 처리:\n\n{\n  \"pblanc_nm\": \"\",\n  \"jrsd_instt_nm\": \"\",\n  \"bsns_sumry_cn\": \"\",\n  \"trget_nm\": \"\",\n  \"reqst_begin_end_de\": \"\",\n  \"reqst_begin_dt\": \"\",\n  \"reqst_end_dt\": \"\",\n  \"reqst_mth_papers_cn\": \"\",\n  \"refrnc_nm\": \"\",\n  \"print_flpth_nm\": \"\",\n  \"print_file_nm\": \"\",\n  \"flpth_nm\": \"\",\n  \"file_nm\": \"\",\n  \"creat_p_nttm\": \"\",\n  \"created_ts\": \"\",\n  \"subsidy_amount\": \"\", \n  \"self_contribution_rate\": \"\",\n  \"support_target\": \"\",\n  \"bonus_points_factors\": \"\",\n  \"total_budget\": \"\"\n}\n\n값이 없으면 반드시 공백(\"\")으로 넣어주세요.\n\n---\n\nmain_category(대분류):  \n공고 주요 분류를 아래 항목 중 정확하게 추출해주세요.  \n복수 해당 시 콤마(,)로 구분.  \n키워드 없거나 애매하면 빈 문자열(\"\").\n\n[선택 가능한 항목]  \n스마트생태공장,상생협력 실증프로그램,스마트공장 / 제조혁신,탄소중립 / 온실가스저감,FEMS 에너지효율화,마케팅 / 기술인프라 구축\n\n예시:  \n\"컨설팅,스마트생태공장\"\n\n---\n\nsub_category(설비분류):  \n공고 내용 중 아래 설비 목록에서 언급된 항목만 골라 콤마(,)로 구분해주세요.  \n목록 외 설비 추가 금지.  \n언급 없으면 빈 문자열(\"\").\n\n[설비 목록]  \n변압기, 폐유재활용설비, 송풍기, 신재생발전설비, 집진기, 펌프, 콤프레셔, 공기조화기, 열회수환기장치,  \n보일러, 열교환기, 배출가스처리기, 공기정화기, 탈황기, 탈질기, 오수처리기, 폐수처리기, 냉각탑,  \n에너지관리시스템, 공정제어시스템, 자동화시스템, 냉동기, 증기재압축장치, 폐열회수시스템, 유수분리기,  \n압축기, 인버터, 용해로, 응축수회수기, 악취저감설비, 사출성형기\n\n예시:  \n\"인버터,용해로\"\n","hasOutputParser":true,"batching":{}},"type":"@n8n/n8n-nodes-langchain.chainLlm","typeVersion":1.7,"position":[560,208],"id":"bcd7d31d-2dd6-4427-9742-ce4670ca4353","name":"Basic LLM Chain1","retryOnFail":false,"maxTries":null,"onError":"continueRegularOutput"},{"parameters":{"assignments":{"assignments":[{"id":"dca754ac-4479-4295-ab21-47d895f62cae","name":"pblanc_nm","value":"={{ $('Code2').item.json.output.pblanc_nm }}","type":"string"},{"id":"0f927bf2-d7a7-4973-aac7-2717bed23371","name":"jrsd_instt_nm","value":"={{ $('Code2').item.json.output.jrsd_instt_nm }}","type":"string"},{"id":"8d6fa575-7d4d-44d6-aaf8-9f967d478af6","name":"bsns_sumry_cn","value":"={{ $('Code2').item.json.output.bsns_sumry_cn }}","type":"string"},{"id":"01a4c2d1-ab75-4e73-90a8-7bf79e5f8cd5","name":"trget_nm","value":"={{ $('Code2').item.json.output.trget_nm }}","type":"string"},{"id":"52d09ff7-1340-4e88-b9e7-0678eda31748","name":"reqst_begin_end_de","value":"={{ $('Code2').item.json.output.reqst_begin_end_de }}","type":"string"},{"id":"47c24bf8-ce6b-40be-a8fd-93d8d1b03a19","name":"reqst_begin_dt","value":"={{ $('Code2').item.json.output.reqst_begin_dt }}","type":"string"},{"id":"e3053a53-0200-4b96-88df-30b9bec65e62","name":"reqst_end_dt","value":"={{ $('Code2').item.json.output.reqst_end_dt }}","type":"string"},{"id":"b78de255-6269-44b3-9097-50b993f40bfc","name":"refrnc_nm","value":"={{ $('Code2').item.json.output.refrnc_nm }}","type":"string"},{"id":"b5e49522-9965-4e13-90b1-86edf56df9c2","name":"print_flpth_nm","value":"={{ $('Code2').item.json.output.print_flpth_nm }}","type":"string"},{"id":"7e662533-f931-4a90-9dfb-f1386c206c8f","name":"print_file_nm","value":"={{ $('Code2').item.json.output.print_file_nm }}","type":"string"},{"id":"607940df-de0c-4780-b040-d59037564076","name":"flpth_nm","value":"=","type":"string"},{"id":"1c9dd011-16d0-42d5-b17d-342b58975048","name":"file_nm","value":"=","type":"string"},{"id":"ad017264-5276-4798-91e5-7bf6f8a07b31","name":"subsidy_amount_type","value":"text","type":"string"},{"id":"0839db3e-060e-4a18-9831-915f28600652","name":"total_budget_type","value":"text","type":"string"},{"id":"f03bb8b7-ece4-439f-9c91-8eb2b09a9aae","name":"source","value":"산업통상자원부","type":"string"},{"id":"aff536ed-a418-4150-b586-d8f02a29010a","name":"is_classified","value":"N","type":"string"},{"id":"70c059fa-5291-4b8a-920d-da0e2bb429a8","name":"del_yn","value":"N","type":"string"},{"id":"4851c2dc-8cec-417d-9243-66fce0c622d7","name":"hide_yn","value":"N","type":"string"},{"id":"27d13c5d-61a2-4bbd-a774-5d43c70cfe02","name":"pldir_sport_realm_lclas_code_nm","value":"기술","type":"string"},{"id":"8e5587d7-89e5-4f54-96a4-ef827461ddf1","name":"creat_p_nttm","value":"={{ $('Code23').item.json.creat_p_nttm }}","type":"string"},{"id":"7ad39a2b-787b-4e1c-92e8-47daa5ff1e66","name":"created_ts","value":"={{ $('Code23').item.json.created_ts }}","type":"string"},{"id":"9adbcf7a-7243-4479-ab01-6b2ccb31d8a6","name":"subsidy_amount","value":"={{ $('Code2').item.json.output.subsidy_amount }}","type":"string"},{"id":"b0d54477-2d5b-4aa1-8905-ca396242ddab","name":"self_contribution_rate","value":"={{ $('Code2').item.json.output.self_contribution_rate }}","type":"string"},{"id":"09d5c3f0-2aa9-424f-ba57-bdd0df8ae9bf","name":"support_target","value":"={{ $('Code2').item.json.output.support_target }}","type":"string"},{"id":"283f473c-7824-46ef-b963-feb711e63a22","name":"=bonus_points_factors","value":"={{ $('Code2').item.json.output.bonus_points_factors }}","type":"string"},{"id":"20d0efcf-9335-4130-ad6e-c50b4f37a404","name":"total_budget","value":"={{ $('Code2').item.json.output.total_budget }}","type":"string"},{"id":"a8021bf2-a695-4d17-b6d8-51e97603dec2","name":"pblanc_url","value":"=https://www.motie.go.kr/kor/article/ATCLc01b2801b","type":"string"},{"id":"1bb27304-ca4d-42d5-8b96-059dbbf0a1f3","name":"main_category","value":"={{ $('Code2').item.json.output.main_category }}","type":"string"},{"id":"3c7f8774-ea90-4a94-be38-4308542676b4","name":"sub_category","value":"={{ $('Code2').item.json.output.sub_category }}","type":"string"},{"id":"d0e48b55-d5a5-4d97-b998-48ba48da1fd2","name":"reqst_mth_papers_cn","value":"={{ $('Code2').item.json.output.reqst_mth_papers_cn }}","type":"string"},{"id":"097340ce-b79e-4727-b490-6246e446ed5e","name":"exc_instt_nm","value":"={{ $('Code2').item.json.output.excInsttNm }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1584,208],"id":"d74fdc0c-63cb-4e76-8d90-83400916d555","name":"ai result","onError":"continueErrorOutput"},{"parameters":{"modelName":"models/gemini-1.5-flash-8b-latest","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[592,432],"id":"be90460c-3fad-4a48-a86a-e9a1f83727cb","name":"Google Gemini Chat Model","credentials":{"googlePalmApi":{"id":"XWAzclOTFyK0A6fs","name":"Google Gemini(PaLM) Api account"}}},{"parameters":{"schemaType":"manual","inputSchema":"{\n  \"$schema\": \"https://json-schema.org/draft/2020-12/schema\",\n  \"$id\": \"https://example.com/product.schema.json\",\n  \"title\": \"anouncement\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"pblanc_nm\": {\n      \"type\": \"string\",\n      \"description\": \"공고제목 (없으면 공백처리)\"\n    },\n    \"jrsd_instt_nm\": {\n      \"type\": \"string\",\n      \"description\": \"공고지역 (없으면 공백처리)\"\n    },\n    \"bsns_sumry_cn\": {\n      \"type\": \"string\",\n      \"description\": \"공고요약 (없으면 공백처리)\"\n    },\n    \"trget_nm\": {\n      \"type\": \"string\",\n      \"description\": \"대상기업 (없으면 공백처리)\"\n    },\n    \"reqst_begin_end_de\": {\n      \"type\": \"string\",\n      \"description\": \"공고 전체 기간 (없으면 reqst_begin_dt ~ reqst_end_dt (yyyymmdd ~ yyyymmdd 형식) 없을시 공백 )\"\n    },\n    \"reqst_begin_dt\": {\n      \"type\": \"string\",\n      \"description\": \"공고 시작 기간 (없으면 공백처리)\"\n    },\n    \"reqst_end_dt\": {\n      \"type\": \"string\",\n      \"description\": \"공고 종료 기간 (없으면 공백처리)\"\n    },\n    \"reqst_mth_papers_cn\": {\n      \"type\": \"string\",\n      \"description\": \"사업신청 방법 (없으면 공백처리)\"\n    },\n    \"excInsttNm\": {\n      \"type\": \"string\",\n      \"description\": \"사업수행기관 (없으면 공백처리)\"\n    },\n    \"refrnc_nm\": {\n      \"type\": \"string\",\n      \"description\": \"문의처내용 (없으면 공백처리)\"\n    },\n    \"print_flpth_nm\": {\n      \"type\": \"string\",\n      \"description\": \"pdf 주소 (없으면 공백처리)\"\n    },\n    \"print_file_nm\": {\n      \"type\": \"string\",\n      \"description\": \"pdf 파일명 (없으면 공백처리)\"\n    },\n    \"subsidy_amount\": {\n      \"type\": \"string\",\n      \"description\": \"지원금액, 원화로 변환 및 금액만 적시 (없으면 공백처리)\"\n    },\n    \"self_contribution_rate\": {\n      \"type\": \"string\",\n      \"description\": \"자부담률 (없으면 공백처리)\"\n    },\n    \"support_target\": {\n      \"type\": \"string\",\n      \"description\": \"지원기업 (예: 대기업, 중소기업, 대명사만 적시, 없으면 공백처리)\"\n    },\n    \"bonus_points_factors\": {\n      \"type\": \"string\",\n      \"description\": \"가점요소(간략하게, 없으면 공백처리)\"\n    },\n    \"total_budget\": {\n      \"type\": \"string\",\n      \"description\": \"예산 (없으면 공백처리)\"\n    },\n    \"main_category\": {\n      \"type\": \"string\",\n      \"description\": \"대분류(없으면 공백)\"\n    },\n    \"sub_category\": {\n      \"type\": \"string\",\n      \"description\": \"설비분류 (없으면 공백처리)\"\n    }\n  }\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[800,608],"id":"eb8a45d4-5628-4d7f-9331-67b29a333f9f","name":"Structured Output Parser1","notesInFlow":false},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.outputParserAutofixing","typeVersion":1,"position":[688,432],"id":"3d22df08-1e46-4869-ab04-e62359c6fdee","name":"Auto-fixing Output Parser"},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4.1-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[688,608],"id":"021a537c-c93d-49ee-82af-430a48ff839d","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"SKDNgNmyz3uaizES","name":"OpenAi account"}}},{"parameters":{"operation":"upsert","table":{"__rl":true,"value":"biz_info","mode":"list","cachedResultName":"biz_info"},"columnToMatchOn":"pblanc_nm","options":{}},"type":"n8n-nodes-base.mySql","typeVersion":2.4,"position":[1968,208],"id":"9bb5f3ef-d8e2-498f-91fd-3cbd376ecfa6","name":"MySQL","retryOnFail":true,"credentials":{"mySql":{"id":"HSXhV0YEF0PlSVWX","name":"MySQL account"}},"onError":"continueRegularOutput"},{"parameters":{"amount":10,"unit":"seconds"},"id":"858b04f2-0490-4e2a-9878-2aaf401bfd14","name":"Wait","type":"n8n-nodes-base.wait","typeVersion":1,"position":[2128,208],"webhookId":"a28b763c-a599-4a25-a2e4-ec30bdaadc43"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"18fccb4a-bd03-4b92-ba4d-202cae02b7a8","leftValue":"={{ $json.pblanc_nm }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1760,208],"id":"2ce9c03f-8202-4a27-94b7-eb85f14ceb5e","name":"If","retryOnFail":false},{"parameters":{"jsCode":"const announcements = items[0].json.announcements || [];\nconst titles = items[0].json.title || [];\nconst dates = items[0].json.date || [];\n\n// 어제 날짜 구하기 (yyyy-mm-dd 형식)\nconst yesterday = new Date();\nyesterday.setDate(yesterday.getDate() - 1);\nconst yesterdayStr = yesterday.toISOString().slice(0, 10); // 예: '2025-06-19'\n\n// const yesterdayStr = '2025-09-12'\nreturn announcements\n  .map((announcement, index) => {\n    return {\n      json: {\n        announcement: announcement,\n        title: titles[index] || null,\n        date: dates[index] || null\n      }\n    };\n  })\n  .filter(item => item.json.date === yesterdayStr);\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-1920,192],"id":"e9fb77e6-362d-4b76-9cbf-490ae46a9c90","name":"금일 기준"},{"parameters":{"content":"사이트 주소\nhttps://www.motie.go.kr/kor/article/ATCLc01b2801b","height":80,"width":740},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-2880,64],"id":"86e46737-46a0-4394-9f48-b5f410469bd6","name":"Sticky Note"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"2d3aee72-46af-4378-99b4-a974ed6c6c5c","leftValue":"={{ $json.pblanc_nm }}","rightValue":"","operator":{"type":"string","operation":"empty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1328,208],"id":"68f20466-1d82-44c4-abaf-be5d1c95ef7a","name":"If2"},{"parameters":{"operation":"select","table":{"__rl":true,"value":"biz_info","mode":"list","cachedResultName":"biz_info"},"where":{"values":[{"column":"pblanc_nm","condition":"LIKE","value":"={{ $json.output.pblanc_nm }}"}]},"options":{}},"type":"n8n-nodes-base.mySql","typeVersion":2.4,"position":[1168,208],"id":"387bc77a-98cc-41b8-bc00-dde5689840b3","name":"MySQL1","alwaysOutputData":true,"credentials":{"mySql":{"id":"HSXhV0YEF0PlSVWX","name":"MySQL account"}}},{"parameters":{"jsCode":"// Loop over input items\nfor (const item of $input.all()) {\n  // 괄호 제거\n  if (item.json.pblanc_nm) {\n    item.json.pblanc_nm = item.json.pblanc_nm.replace(/[\\(\\[][^()\\[\\]]+[\\)\\]]/g, '').trim();\n  }\n\n  // 새 필드 추가\n  item.json.myNewField = 1;\n}\n\nreturn $input.all();"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[992,208],"id":"49df7a03-47fd-4dfd-902b-1fcac9056166","name":"Code2"},{"parameters":{"jsCode":"let title = $input.first().json.title || '';\n\n// 괄호 또는 대괄호 안의 내용 제거\ntitle = title.replace(/[\\(\\[][^()\\[\\]]+[\\)\\]]/g, '').trim();\n\nreturn [\n  {\n    json: {\n      title\n    }\n  }\n];\n\n\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-1520,0],"id":"c3104b48-12ab-4688-89de-c723364c665f","name":"중복 자료 조회"},{"parameters":{"operation":"select","table":{"__rl":true,"value":"biz_info","mode":"list","cachedResultName":"biz_info"},"where":{"values":[{"column":"pblanc_nm","condition":"LIKE","value":"={{ $json.title }}"}]},"options":{}},"type":"n8n-nodes-base.mySql","typeVersion":2.4,"position":[-1376,0],"id":"672db1f2-0fa9-428d-91ea-4e80f9c429c4","name":"중복조회 MYSQL","alwaysOutputData":true,"credentials":{"mySql":{"id":"HSXhV0YEF0PlSVWX","name":"MySQL account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"2d3aee72-46af-4378-99b4-a974ed6c6c5c","leftValue":"={{ $json.pblanc_nm }}","rightValue":"","operator":{"type":"string","operation":"empty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-1248,0],"id":"495dd0bc-8908-481f-931b-b3b9e8966e32","name":"중복조회 IF"},{"parameters":{"rule":{"interval":[{"triggerAtHour":23,"triggerAtMinute":30},{"triggerAtHour":11,"triggerAtMinute":30}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-2880,192],"id":"b089168b-df2f-463e-ad99-63841065d89a","name":"Schedule Trigger"}],"connections":{"HTTP Request3":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"HTTP Request4","type":"main","index":0}]]},"HTTP Request4":{"main":[[{"node":"리스트 추출1","type":"main","index":0}]]},"리스트 추출1":{"main":[[{"node":"금일 기준","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"중복 자료 조회","type":"main","index":0}]]},"HTTP Request7":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code1":{"main":[[{"node":"HTTP Request6","type":"main","index":0}]]},"HTTP Request6":{"main":[[{"node":"Upload a file9","type":"main","index":0}]]},"Upload a file1":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]},"HTTP Request1":{"main":[[{"node":"do ocr1","type":"main","index":0}]]},"Upload a file9":{"main":[[{"node":"Upload a file1","type":"main","index":0}]]},"do ocr1":{"main":[[{"node":"Code23","type":"main","index":0}]]},"Basic LLM Chain1":{"main":[[{"node":"Code2","type":"main","index":0}]]},"Code23":{"main":[[{"node":"Basic LLM Chain1","type":"main","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"Basic LLM Chain1","type":"ai_languageModel","index":0}]]},"Structured Output Parser1":{"ai_outputParser":[[{"node":"Auto-fixing Output Parser","type":"ai_outputParser","index":0}]]},"Auto-fixing Output Parser":{"ai_outputParser":[[{"node":"Basic LLM Chain1","type":"ai_outputParser","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"Auto-fixing Output Parser","type":"ai_languageModel","index":0}]]},"MySQL":{"main":[[{"node":"Wait","type":"main","index":0}]]},"If":{"main":[[{"node":"MySQL","type":"main","index":0}]]},"ai result":{"main":[[{"node":"If","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"금일 기준":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"MySQL1":{"main":[[{"node":"If2","type":"main","index":0}]]},"Code2":{"main":[[{"node":"MySQL1","type":"main","index":0}]]},"If2":{"main":[[{"node":"ai result","type":"main","index":0}],[{"node":"Loop Over Items","type":"main","index":0}]]},"중복 자료 조회":{"main":[[{"node":"중복조회 MYSQL","type":"main","index":0}]]},"중복조회 MYSQL":{"main":[[{"node":"중복조회 IF","type":"main","index":0}]]},"중복조회 IF":{"main":[[{"node":"HTTP Request7","type":"main","index":0}],[{"node":"Loop Over Items","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","timezone":"Asia/Seoul","callerPolicy":"workflowsFromSameOwner","errorWorkflow":"Mlhukb9mbuzpvwkH"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"56e21b0f-8100-4788-8345-93d527ff0321","triggerCount":1,"shared":[{"createdAt":"2025-06-18T07:35:02.850Z","updatedAt":"2025-06-18T07:35:02.850Z","role":"workflow:owner","workflowId":"4nYBePGh3oMxitVI","projectId":"YGqg9zdxGQSC73yC"}],"tags":[]}