{"createdAt":"2025-09-03T01:13:07.353Z","updatedAt":"2025-09-03T01:19:20.732Z","id":"ycpALpwvPwx3Z2cf","name":"My workflow 9","active":true,"isArchived":true,"nodes":[{"parameters":{},"id":"ef1871a1-063b-4c90-b82b-fd566d4a92ba","name":"On clicking 'execute'","type":"n8n-nodes-base.manualTrigger","position":[320,0],"typeVersion":1,"disabled":true},{"parameters":{"content":"## Subworkflow","height":731.7039821513649,"width":1910.7813046051347,"color":6},"id":"de7d524c-8f19-4517-bba3-8f8bd67b50e8","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[-160,384],"typeVersion":1},{"parameters":{},"id":"9091ebab-36ed-4bca-a77e-561cd543a88c","name":"Execute Workflow Trigger","type":"n8n-nodes-base.executeWorkflowTrigger","position":[-96,768],"typeVersion":1},{"parameters":{"filters":{},"requestOptions":{}},"id":"18928392-08ae-409b-be40-93c879cec6bf","name":"n8n","type":"n8n-nodes-base.n8n","position":[720,112],"typeVersion":1},{"parameters":{"assignments":{"assignments":[{"id":"8d513345-6484-431f-afb7-7cf045c90f4f","name":"Done","type":"boolean","value":true}]},"options":{}},"id":"be64c897-22b3-4b05-aa84-79c9bc528e9b","name":"Return","type":"n8n-nodes-base.set","position":[1568,592],"typeVersion":3.3},{"parameters":{"url":"={{ $json.download_url }}","options":{}},"id":"a9f779a8-2ca2-4994-87b5-06aa882072de","name":"Get File","type":"n8n-nodes-base.httpRequest","position":[528,464],"typeVersion":4.2},{"parameters":{"conditions":{"options":{"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"45ce825e-9fa6-430c-8931-9aaf22c42585","operator":{"type":"string","operation":"empty","singleValue":true},"leftValue":"={{ $json.content }}","rightValue":""},{"id":"9619a55f-7fb1-4f24-b1a7-7aeb82365806","operator":{"type":"string","operation":"notExists","singleValue":true},"leftValue":"={{ $json.error }}","rightValue":""}]},"options":{}},"id":"465b4e59-678a-473c-9351-e2da27621442","name":"If file too large","type":"n8n-nodes-base.if","position":[288,480],"typeVersion":2},{"parameters":{},"id":"9020fb9f-4434-46ad-9e87-a58b9bda4e37","name":"Merge Items","type":"n8n-nodes-base.merge","position":[288,752],"typeVersion":2},{"parameters":{"jsCode":"const orderJsonKeys = (jsonObj) => {\n  const ordered = {};\n  Object.keys(jsonObj).sort().forEach(key => {\n    ordered[key] = jsonObj[key];\n  });\n  return ordered;\n}\n\n// Check if file returned with content\nif (Object.keys($input.all()[0].json).includes(\"content\")) {\n  // Decode base64 content and parse JSON\n  const origWorkflow = JSON.parse(Buffer.from($input.all()[0].json.content, 'base64').toString());\n  const n8nWorkflow = $input.all()[1].json;\n  \n  // Order JSON objects\n  const orderedOriginal = orderJsonKeys(origWorkflow);\n  const orderedActual = orderJsonKeys(n8nWorkflow);\n\n  // Determine difference\n  if (JSON.stringify(orderedOriginal) === JSON.stringify(orderedActual)) {\n    $input.all()[0].json.github_status = \"same\";\n  } else {\n    $input.all()[0].json.github_status = \"different\";\n    $input.all()[0].json.n8n_data_stringy = JSON.stringify(orderedActual, null, 2);\n  }\n  $input.all()[0].json.content_decoded = orderedOriginal;\n// No file returned / new workflow\n} else if (Object.keys($input.all()[0].json).includes(\"data\")) {\n  const origWorkflow = JSON.parse($input.all()[0].json.data);\n  const n8nWorkflow = $input.all()[1].json;\n  \n  // Order JSON objects\n  const orderedOriginal = orderJsonKeys(origWorkflow);\n  const orderedActual = orderJsonKeys(n8nWorkflow);\n\n  // Determine difference\n  if (JSON.stringify(orderedOriginal) === JSON.stringify(orderedActual)) {\n    $input.all()[0].json.github_status = \"same\";\n  } else {\n    $input.all()[0].json.github_status = \"different\";\n    $input.all()[0].json.n8n_data_stringy = JSON.stringify(orderedActual, null, 2);\n  }\n  $input.all()[0].json.content_decoded = orderedOriginal;\n\n} else {\n  // Order JSON object\n  const n8nWorkflow = $input.all()[1].json;\n  const orderedActual = orderJsonKeys(n8nWorkflow);\n  \n  // Proper formatting\n  $input.all()[0].json.github_status = \"new\";\n  $input.all()[0].json.n8n_data_stringy = JSON.stringify(orderedActual, null, 2);\n}\n\n// Return items\nreturn $input.all();\n"},"id":"b9800084-a206-4145-987d-4862050e2b65","name":"isDiffOrNew","type":"n8n-nodes-base.code","position":[480,752],"typeVersion":1},{"parameters":{"dataType":"string","value1":"={{$json.github_status}}","rules":{"rules":[{"value2":"same"},{"value2":"different","output":1},{"value2":"new","output":2}]}},"id":"c342753c-b81b-44c2-b2f5-b76ad7b8e204","name":"Check Status","type":"n8n-nodes-base.switch","position":[880,752],"typeVersion":1},{"parameters":{},"id":"e32ce38c-7f39-4d0d-be74-f3c8ca2f019b","name":"Same file - Do nothing","type":"n8n-nodes-base.noOp","position":[1104,592],"typeVersion":1},{"parameters":{},"id":"77707186-f9c9-4db0-b9dd-31cd07690a7e","name":"File is different","type":"n8n-nodes-base.noOp","position":[1104,752],"typeVersion":1},{"parameters":{},"id":"321f8228-fb88-4d39-a1b5-21e6880c7aa5","name":"File is new","type":"n8n-nodes-base.noOp","position":[1104,944],"typeVersion":1},{"parameters":{"resource":"file","owner":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_owner }}"},"repository":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_name }}"},"filePath":"={{ $('Config').first().item.repo_path }}{{ $json.subPath }}{{$('Execute Workflow Trigger').first().json.id}}.json","fileContent":"={{$('isDiffOrNew').item.json[\"n8n_data_stringy\"]}}","commitMessage":"={{$('Execute Workflow Trigger').first().json.name}} ({{$json.github_status}})"},"id":"a003bb07-b49d-48d7-80f6-37a304903a1c","name":"Create new file","type":"n8n-nodes-base.github","position":[1328,944],"typeVersion":1,"webhookId":"ba06d804-547f-4d7f-ae8b-9a5980c54be2"},{"parameters":{"resource":"file","operation":"edit","owner":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_owner }}"},"repository":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_name }}"},"filePath":"={{ $('Config').first().item.repo_path }}{{ $json.subPath }}{{$('Execute Workflow Trigger').first().json.id}}.json","fileContent":"={{$('isDiffOrNew').item.json[\"n8n_data_stringy\"]}}","commitMessage":"={{$('Execute Workflow Trigger').first().json.name}} ({{$json.github_status}})"},"id":"88b01b20-5530-4483-b1e1-b3c91c15723c","name":"Edit existing file","type":"n8n-nodes-base.github","position":[1328,752],"typeVersion":1,"webhookId":"bc2a757e-9548-4c67-a973-6cb69a2f67d3"},{"parameters":{"options":{}},"id":"60875e3b-00ae-4218-965e-5cd46cc952c4","name":"Loop Over Items","type":"n8n-nodes-base.splitInBatches","position":[928,112],"typeVersion":3},{"parameters":{"rule":{"interval":[{"triggerAtHour":1,"triggerAtMinute":33}]}},"id":"aa8dbfbc-21e6-4c15-a702-40e3dfdd5644","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","position":[320,208],"typeVersion":1.2,"disabled":true},{"parameters":{"assignments":{"assignments":[{"id":"dae43d3b-56e5-4098-b602-862ebf5cd073","name":"subPath","type":"string","value":"={{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[0] }}/{{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[1] }}/"}]},"includeOtherFields":true,"options":{}},"id":"86a518d8-ab28-4c4a-b303-75c2b6e1107c","name":"Create sub path","type":"n8n-nodes-base.set","position":[688,752],"typeVersion":3.3},{"parameters":{"content":"## Backup to GitHub \nThis workflow will backup all instance workflows to GitHub every 24 hours.\n\nThe files are saved into folders using `YYYY/MM/` for the directory path and `ID.json` for the filename.\n\nThe Repo Owner, Repo Name and Main folder are set using the **Variables** feature but can be replaced with the `Config` node in the subworkflow. \n\nThe workflow runs calls itself to help reduce memory usage, Once the workflow has completed it will send an optional notification to Slack.\n\n### Time to Run\nTested with 1423 workflows on `1.44.1` it took under 30 minutes for the first run and under 12 minutes once the initial run is complete.","height":417,"width":385,"color":4},"id":"156ab44f-b242-4756-833d-9bb701d39385","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[-160,-80],"typeVersion":1},{"parameters":{"content":"## Main workflow loop","height":416.1856906618075,"width":1272.6408145680155,"color":7},"id":"91ea4a93-0df7-4a3c-94fe-eba496f51509","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[288,-80],"typeVersion":1},{"parameters":{"select":"channel","channelId":{"__rl":true,"mode":"name","value":"#notifications"},"text":"=:information_source:  Starting Workflow Backup [{{ $execution.id }}]","otherOptions":{"includeLinkToWorkflow":false}},"id":"755eed1f-82ae-4596-863c-842901cab92c","name":"Starting Message","type":"n8n-nodes-base.slack","position":[560,112],"webhookId":"c02eb407-5547-4aa0-9ebf-46dab67b63b6","typeVersion":2.2},{"parameters":{"workflowId":"={{ $workflow.id }}","mode":"each","options":{}},"id":"35e63fcc-fd1c-47c6-b154-d5bd1c25aaa6","name":"Execute Workflow","type":"n8n-nodes-base.executeWorkflow","position":[1152,128],"typeVersion":1,"onError":"continueErrorOutput"},{"parameters":{"select":"channel","channelId":{"__rl":true,"mode":"name","value":"#notifications"},"text":"=âœ… Backup has completed - {{ $('n8n').all().length }} workflows have been processed.","otherOptions":{}},"id":"4c4848be-24d0-44e7-8aae-65b0fd325b69","name":"Completed Notification","type":"n8n-nodes-base.slack","position":[1152,-64],"webhookId":"a0c6e8c8-5d71-40fa-b02b-63a7ed5726c4","executeOnce":true,"typeVersion":2.2},{"parameters":{"select":"channel","channelId":{"__rl":true,"mode":"name","value":"#notifications"},"text":"=:x: Failed to backup {{ $('Loop Over Items').item.json.id }}","otherOptions":{"includeLinkToWorkflow":false}},"id":"48ca3b8d-ee9c-4149-ad3d-74d892ac9428","name":"Failed Flows","type":"n8n-nodes-base.slack","position":[1344,144],"webhookId":"2a092edb-de12-490f-931b-34d70e7d7696","typeVersion":2.2},{"parameters":{"resource":"file","operation":"get","owner":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_owner }}"},"repository":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_name }}"},"filePath":"={{ $('Config').first().item.repo_path }}{{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[0] }}/{{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[1] }}/{{$json.id}}.json","asBinaryProperty":false,"additionalParameters":{}},"id":"4098af12-6a41-4e9b-bad0-bb7ede024aaa","name":"Get file data","type":"n8n-nodes-base.github","position":[80,480],"typeVersion":1,"alwaysOutputData":true,"webhookId":"5887f0f2-c98e-419a-85bd-ee0a2fb909f6","continueOnFail":true},{"parameters":{"assignments":{"assignments":[{"id":"8f6d1741-772f-462a-811f-4c334185e4f0","name":"repo_owner","type":"string","value":"={{ $vars.repo_owner }}"},{"id":"8cac215c-4fd7-422f-9fd2-6b2d1e5e0383","name":"repo_name","type":"string","value":"={{ $vars.repo_name }}"},{"id":"eee305e9-4164-462a-86bd-80f0d58a31ae","name":"repo_path","type":"string","value":"={{ $vars.repo_path }}"}]},"includeOtherFields":true,"options":{}},"id":"74902752-7ddd-4a5a-8554-a917838da314","name":"Config","type":"n8n-nodes-base.set","position":[80,768],"typeVersion":3.4}],"connections":{"n8n":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Config":{"main":[[{"node":"Get file data","type":"main","index":0},{"node":"Merge Items","type":"main","index":1}]]},"Get File":{"main":[[{"node":"Merge Items","type":"main","index":0}]]},"File is new":{"main":[[{"node":"Create new file","type":"main","index":0}]]},"Merge Items":{"main":[[{"node":"isDiffOrNew","type":"main","index":0}]]},"isDiffOrNew":{"main":[[{"node":"Create sub path","type":"main","index":0}]]},"Check Status":{"main":[[{"node":"Same file - Do nothing","type":"main","index":0}],[{"node":"File is different","type":"main","index":0}],[{"node":"File is new","type":"main","index":0}]]},"Failed Flows":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Get file data":{"main":[[{"node":"If file too large","type":"main","index":0}]]},"Create new file":{"main":[[{"node":"Return","type":"main","index":0}]]},"Create sub path":{"main":[[{"node":"Check Status","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"Completed Notification","type":"main","index":0}],[{"node":"Execute Workflow","type":"main","index":0}]]},"Execute Workflow":{"main":[[{"node":"Loop Over Items","type":"main","index":0}],[{"node":"Failed Flows","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"Starting Message","type":"main","index":0}]]},"Starting Message":{"main":[[{"node":"n8n","type":"main","index":0}]]},"File is different":{"main":[[{"node":"Edit existing file","type":"main","index":0}]]},"If file too large":{"main":[[{"node":"Get File","type":"main","index":0}],[{"node":"Merge Items","type":"main","index":0}]]},"Edit existing file":{"main":[[{"node":"Return","type":"main","index":0}]]},"On clicking 'execute'":{"main":[[{"node":"Starting Message","type":"main","index":0}]]},"Same file - Do nothing":{"main":[[{"node":"Return","type":"main","index":0}]]},"Execute Workflow Trigger":{"main":[[{"node":"Config","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"b4cf0c22-c21c-4794-b89c-1ed83e47a9d3","triggerCount":0,"shared":[{"createdAt":"2025-09-03T01:13:07.353Z","updatedAt":"2025-09-03T01:13:07.353Z","role":"workflow:owner","workflowId":"ycpALpwvPwx3Z2cf","projectId":"YGqg9zdxGQSC73yC"}],"tags":[]}