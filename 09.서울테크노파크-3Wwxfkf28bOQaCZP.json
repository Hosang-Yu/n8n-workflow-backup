{"createdAt":"2025-06-16T01:02:10.928Z","updatedAt":"2025-08-04T05:44:18.538Z","id":"3Wwxfkf28bOQaCZP","name":"09.서울테크노파크","active":true,"isArchived":false,"nodes":[{"parameters":{"operation":"upsert","table":{"__rl":true,"value":"biz_info","mode":"list","cachedResultName":"biz_info"},"columnToMatchOn":"pblanc_nm","options":{}},"type":"n8n-nodes-base.mySql","typeVersion":2.4,"position":[1660,60],"id":"28268f5a-685f-4170-b9fb-db82687df4b5","name":"MySQL","credentials":{"mySql":{"id":"HSXhV0YEF0PlSVWX","name":"MySQL account"}}},{"parameters":{"jsCode":"return $input.first().json.imgs.map((img) =>{\n  // const match = img.match(/(?:\\?|&)attachNo=([0-9]+)(?:&|$)/);\n  // const match2 = match[0].replaceAll(\"'\", \"\");\n\n  return {img: img};\n});"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-160,580],"id":"684de8e2-f734-4ba4-8740-6bf3514b3892","name":"prepare image addr"},{"parameters":{"method":"POST","url":"https://api.mistral.ai/v1/ocr","authentication":"predefinedCredentialType","nodeCredentialType":"mistralCloudApi","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"model\": \"mistral-ocr-latest\",\n  \"document\": {\n    \"type\": \"image_url\",\n    \"image_url\": \"{{ $json.url }}\"\n  },\n  \"include_image_base64\": true\n}","options":{"allowUnauthorizedCerts":false,"response":{"response":{"responseFormat":"json"}}}},"id":"80aafb3a-9faa-4ef8-a465-00cdf6d34743","name":"do ocr1","type":"n8n-nodes-base.httpRequest","position":[1240,600],"typeVersion":4.2,"alwaysOutputData":true,"credentials":{"mistralCloudApi":{"id":"DMvGIk4nGb1Gfy0K","name":"Mistral Cloud account 2"}}},{"parameters":{"url":"={{ $json.base_url + $json.board_list}}?page=2","responseFormat":"string","options":{}},"name":"board list1","type":"n8n-nodes-base.httpRequest","position":[-2380,560],"typeVersion":1,"id":"e397e684-bf84-46a0-b15f-e58bd7c8a62c"},{"parameters":{"extractionValues":{"values":[{"key":"announcements","cssSelector":"table > tbody > tr > td > a","returnValue":"attribute","attribute":"href","returnArray":true}]},"options":{"trimValues":true}},"name":"html extract board detail list1","type":"n8n-nodes-base.htmlExtract","position":[-2160,560],"typeVersion":1,"id":"718a4ca5-1fc9-4744-b919-909b35453891"},{"parameters":{"functionCode":"return items[0].json.announcements.map(function(announcement) {\n  const match = announcement.match(/'(\\d{8})'/);\n  const match2 = match[0].replaceAll(\"'\", \"\");\n  match2.trim();\n  return {\n  json: {announcement: match2}\n  }\n});"},"name":"Prepare announcement1","type":"n8n-nodes-base.function","position":[-1820,560],"typeVersion":1,"id":"d3929dfd-f683-417f-801f-c445ee1399bb"},{"parameters":{"url":"={{ $('변수설정1').item.json.base_url + $('변수설정1').item.json.board_list }}?View&boardNo={{ $json.announcement }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-1340,580],"id":"c23e0915-142c-4f52-bc71-d4c1b1f72af7","name":"get detail1"},{"parameters":{"operation":"extractHtmlContent","dataPropertyName":"=data","extractionValues":{"values":[{"key":"img","cssSelector":"table > tbody > tr > td > div > p > a > img","returnValue":"attribute","attribute":"src","returnArray":true},{"key":"img2","cssSelector":".table-cont > p > img","returnValue":"attribute","attribute":"src","returnArray":true},{"key":"title","cssSelector":".board-write > tbody > tr:nth-child(1) > td"},{"key":"download","cssSelector":".board-write > tbody > tr > td > .downfile-list > li > a","returnValue":"attribute","attribute":"onclick","returnArray":true},{"key":"author","cssSelector":".board-write > tbody > tr:nth-child(2) > td"},{"key":"date","cssSelector":".board-write > tbody > tr:nth-child(3) > td"},{"key":"download-file-name","cssSelector":".board-write > tbody > tr > td > .downfile-list > li > a","returnValue":"=text","returnArray":true}]},"options":{}},"type":"n8n-nodes-base.html","typeVersion":1.2,"position":[-1160,580],"id":"de93c455-55f1-46d8-ad14-742b294cfefe","name":"extract img list1","onError":"continueRegularOutput"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"987498f6-b083-4f58-b8a4-62f111640464","leftValue":"={{ $('Edit Fields2').item.json.date }}\n","rightValue":"={{ $today.minus(1, 'days') }}","operator":{"type":"dateTime","operation":"afterOrEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-340,580],"id":"dccfaf77-5e2a-4ea8-9ba4-cf4c5ee4f5a7","name":"is it today?1"},{"parameters":{"url":"={{ $json.img }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Disposition"}]},"options":{"response":{"response":{"fullResponse":true,"responseFormat":"file"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[580,540],"id":"3d8d4dea-6869-442a-b623-3144e31a3933","name":"get img2","alwaysOutputData":true},{"parameters":{"method":"POST","url":"https://api.mistral.ai/v1/files","authentication":"predefinedCredentialType","nodeCredentialType":"mistralCloudApi","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"name":"purpose","value":"ocr"},{"parameterType":"formBinaryData","name":"=file","inputDataFieldName":"data"}]},"options":{"allowUnauthorizedCerts":false}},"id":"6b1ceac4-33b2-4c49-9982-c1395b429be3","name":"Upload a img1","type":"n8n-nodes-base.httpRequest","position":[780,600],"typeVersion":4.2,"alwaysOutputData":true,"credentials":{"mistralCloudApi":{"id":"DMvGIk4nGb1Gfy0K","name":"Mistral Cloud account 2"}}},{"parameters":{"url":"=https://api.mistral.ai/v1/files/{{ $json.id }}","authentication":"predefinedCredentialType","nodeCredentialType":"mistralCloudApi","options":{"allowUnauthorizedCerts":false}},"id":"52bc9b75-c58b-43fa-8d37-daad9505c872","name":"Retrieve img1","type":"n8n-nodes-base.httpRequest","position":[920,600],"typeVersion":4.2,"credentials":{"mistralCloudApi":{"id":"DMvGIk4nGb1Gfy0K","name":"Mistral Cloud account 2"}}},{"parameters":{"url":"=https://api.mistral.ai/v1/files/{{ $json.id }}/url","authentication":"predefinedCredentialType","nodeCredentialType":"mistralCloudApi","sendQuery":true,"queryParameters":{"parameters":[{"name":"expiry","value":"24"}]},"options":{"allowUnauthorizedCerts":false}},"id":"fdcb9e43-cc33-48ae-904e-ef192ea6da90","name":"Retrieve img3","type":"n8n-nodes-base.httpRequest","position":[1080,600],"typeVersion":4.2,"credentials":{"mistralCloudApi":{"id":"DMvGIk4nGb1Gfy0K","name":"Mistral Cloud account 2"}}},{"parameters":{"url":"={{ $('변수설정1').item.json.base_url  +  $json.img }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Disposition"}]},"options":{"response":{"response":{"fullResponse":true,"responseFormat":"file"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[580,680],"id":"09c3cc79-3368-41e1-972e-8fec17fa635c","name":"get img3","alwaysOutputData":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"8b678027-4ef0-48a2-be86-69f6234163bc","leftValue":"={{ $json.list }}","rightValue":"http","operator":{"type":"string","operation":"startsWith"}},{"id":"b89a7288-14b1-482f-83ac-6239ea5c0139","leftValue":"={{ $json.list }}","rightValue":"https","operator":{"type":"string","operation":"startsWith"}}],"combinator":"or"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[260,600],"id":"432e1330-4e0d-40e4-ae06-d87c7dfa54fa","name":"url starts with http or https1"},{"parameters":{},"id":"01bd1afc-159e-408c-a22c-7c67ca5d9296","name":"NoOp1","type":"n8n-nodes-base.noOp","position":[1400,600],"typeVersion":1},{"parameters":{"options":{"reset":"={{ $node[\"Loop Over Items2\"].context[\"done\"] }}"}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[-1560,560],"id":"462fefa1-93a9-4306-ae74-14f8df12ad42","name":"Loop Over Items2"},{"parameters":{"batchSize":"={{ $json.img.length }}","options":{"reset":"={{ $node[\"Loop Over Items3\"].context[\"done\"] }}"}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[40,580],"id":"67ce1a20-ef8a-4550-803b-871b0486aadb","name":"Loop Over Items3"},{"parameters":{"fieldsToSummarize":{"values":[{"aggregation":"append","field":"pages[0].markdown"}]},"options":{"outputFormat":"singleItem"}},"type":"n8n-nodes-base.summarize","typeVersion":1.1,"position":[260,60],"id":"c7237dfe-6133-48b2-bb32-97ca185ba7b7","name":"Summarize"},{"parameters":{"mode":"raw","jsonOutput":"{\n  \"base_url\": \"https://www.seoultp.or.kr\",\n  \"board_list\": \"/user/nd19746.do\",\n  \"api_key\":\"gqWjltgMgARE3CsbEOXptHkJeXetB4gO\",\n  \"attach_url\": \"https://www.seoultp.or.kr/common/attachfile/attachfileDownload.do?attachNo=\",\n  \"source\": \"서울테크노파크\",\n  \"cityMap\": {   \"서울\": \"서울특별시\",   \"부산\": \"부산광역시\",   \"대구\": \"대구광역시\",   \"인천\": \"인천광역시\",   \"광주\": \"광주광역시\",   \"대전\": \"대전광역시\",   \"울산\": \"울산광역시\",   \"세종\": \"세종특별자치시\",   \"경기\": \"경기도\",   \"강원\": \"강원도\",   \"충북\": \"충청북도\",   \"충남\": \"충청남도\",   \"전북\": \"전라북도\",   \"전남\": \"전라남도\",   \"경북\": \"경상북도\",   \"경남\": \"경상남도\",   \"제주\": \"제주특별자치도\",   \"전지역\": \"전지역\" }\n}","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-2560,560],"id":"4ba873d9-e7dd-4194-84ed-b928dfcadaad","name":"변수설정1"},{"parameters":{"assignments":{"assignments":[{"id":"db86008e-ffea-4dd3-b12c-eb9d5087ad7c","name":"pblanc_nm","value":"={{ $json.title }}","type":"string"},{"id":"c315a533-97f3-40d7-8f3e-b3bae337323c","name":"date","value":"={{ $json.date }}","type":"string"},{"id":"b04c634c-8aaf-4b8f-877f-72995e5cadcc","name":"imgs","value":"={{ $json.img }}","type":"array"},{"id":"cc2fb364-0250-4408-93b5-6e968598ce33","name":"print_flpth_nm","value":"={{ $json.print_flpth_nm }}","type":"string"},{"id":"96d4784c-3dc9-4b59-bb59-82b4bd91bf7d","name":"print_file_nm","value":"={{ $json.print_file_nm }}","type":"string"},{"id":"cd9f6a54-57a5-48e4-ae30-04ecf25ed0a3","name":"flpth_nm","value":"={{ $json.flpth_nm }}","type":"string"},{"id":"c27766b0-0055-43f5-9fbd-c8d14b5b9560","name":"file_nm","value":"={{ $json.file_nm }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-840,580],"id":"dbdad172-e652-4810-a273-b8f82d89dd49","name":"Edit Fields2","onError":"continueRegularOutput"},{"parameters":{"assignments":{"assignments":[{"id":"db86008e-ffea-4dd3-b12c-eb9d5087ad7c","name":"pblanc_nm","value":"","type":"string"},{"id":"6c5d9cd9-8615-4b24-9877-85bc3212838e","name":"jrsd_instt_nm","value":"","type":"string"},{"id":"d5d8167a-b583-4be1-acd3-7f0a7a670db4","name":"bsns_sumry_cn","value":"","type":"string"},{"id":"8b1d7818-c19d-4e71-8f92-eb189ac74c2f","name":"print_flpth_nm","value":"","type":"string"},{"id":"024227d2-c0d4-41cf-8861-18253133de44","name":"print_file_nm","value":"","type":"string"},{"id":"3128702e-55ec-4b48-bf10-c6ad64cf22d8","name":"flpth_nm","value":"","type":"string"},{"id":"4fe7272a-2b3b-44b0-a516-17728f425834","name":"file_nm","value":"","type":"string"},{"id":"6d92a68b-a296-4b78-833d-327ecd397459","name":"trget_nm","value":"","type":"string"},{"id":"6946fd74-8e26-4d32-a7d9-2598963cdc1d","name":"reqst_begin_end_de","value":"","type":"string"},{"id":"7bb3c27c-2f02-45c8-ae78-1f3056f3e16e","name":"reqst_begin_dt","value":"","type":"string"},{"id":"cf2e7999-d720-400e-9cc5-4f3c28aaecf3","name":"reqst_mth_papers_cn","value":"","type":"string"},{"id":"33fc6441-0da2-4b2d-b3a8-6ea254feaa82","name":"refrnc_nm","value":"","type":"string"},{"id":"e5ccd168-6b14-450f-8bed-a6d8d24a69d6","name":"hash_tags","value":"","type":"string"},{"id":"e51a8bf0-48c4-49bd-90c2-7f0e969b3cb5","name":"is_classified","value":"N","type":"string"},{"id":"e1d8ebcb-4bd9-4b05-9847-c090a8fa1de9","name":"source","value":"서울테크노파크","type":"string"},{"id":"f3810748-7fe3-461f-8cc7-06906cbdeb4a","name":"subsidy_amount_type","value":"text","type":"string"},{"id":"3db963f3-f950-42ad-9068-80ed7c01535c","name":"total_budget_type","value":"text","type":"string"},{"id":"85f6b1b3-d733-43ac-9c6e-868e7efa55a8","name":"announcement","value":"={{ $json.announcement }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1540,1160],"id":"33b0d8c1-5abc-4ab4-97e2-b779aeb9962f","name":"Edit Fields3","onError":"continueRegularOutput"},{"parameters":{"jsCode":"\n\nconst flpth_nm_list = $input.first().json.download.map((item) =>{\n  const a = item.match(/'(\\d{8})'/);\n  if(a == null) return \"\";\n  return $('변수설정1').first().json.attach_url  + a[1]\n});\n\nconst file_nm_list = $input.first().json[\"download-file-name\"];\n\nconst print_flpth_nm = flpth_nm_list[0];\nconst flpth_nm = flpth_nm_list.join(\"@\");\n\nconst print_file_nm = file_nm_list[0];\nconst file_nm = file_nm_list.join(\"@\");\n\n\n\nreturn {title: $input.first().json.title,\n        date: $input.first().json.date,\n        img: $input.first().json.img.concat($input.first().json.img2),\n        print_flpth_nm: print_flpth_nm,\n        print_file_nm: print_file_nm,\n        flpth_nm: flpth_nm,\n        file_nm: file_nm\n       }"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-980,580],"id":"462f33ea-2d75-41b9-ad2c-85ad54884326","name":"Code2"},{"parameters":{"promptType":"define","text":"={{ $json.appended_pages0_markdown }} \\n에서 pblanc_nm(공고제목), jrsd_instt_nm(대상 지역), 주최기관(exc_instt_nm), bsns_sumry_cn(공고요약), target_nm(대상기업), reqst_begin_end_de(공고 전체기간 형식은 ***'YYYYMMDD ~ YYYYMMDD'***), reqst_begin_dt(공고시작기간 YYYY-MM-DD), reqst_end_dt(공고마감기간 YYYY-MM-DD), reqst_mth_papers_cn(사업신청방법), refrnc_nm(문의처), 지원금액(subsidy_amount), 가점요소(bonus_points_factors), 예산(total_budget), 자부담률(self_contribution_rate) 에 대한 정보를 알려줘 만약 자료가 없다면 null으로라도 알려줘 응답은 json형태야 또한 지역명(jrsd_instt_nm)이 {{ $('변수설정1').json.item.cityMap.values().join(',') }} 중 하나로 출력되게 해주고, 만약 없다면 null로 출력해줘 그리고 reqst_begin_end_de(공고 전체기간의 형식은 반드시 YYYYMMDD ~ YYYYMMDD 의 형태로 해줘 그리고 대상기업(target_nm)은 중소기업,대기업 중 골라서 해주고 둘다 지원한다면 중소기업,대기업 으로 출력해줘 알 수 없으면 null이야\n\n\n\nmain_category(대분류): 공고의 주요 분류를 다음 항목 중에서 정확하게 추출해줘.  \n해당되는 항목이 여러 개인 경우 콤마(,)로 구분해서 출력해줘.  \n아래 항목 중 적절한 키워드가 공고 내용에 존재할 경우, 가장 가까운 항목으로 판단해서 선택해줘.  \n단, 명확한 키워드가 없거나 분류하기 애매한 경우에는 빈 문자열(\"\")로 표시해줘.  \n\n[선택 가능한 항목 목록]  \n컨설팅, 스마트생태공장, 에너지효율화, FEMS/MES, 온실가스저감, 기타설비지원  \n\n출력 예시:  \n\"컨설팅,스마트생태공장\"\n\n---\n\nsub_category(설비분류): 공고 내용 중 다음 설비 목록에서 언급된 항목만 골라 콤마(,)로 구분하여 출력해줘.  \n유사 표현이 있을 경우 판단해서 포함해도 되지만, **아래 목록에 없는 항목은 절대 추가하지 마세요.**  \n어떤 설비도 언급되지 않았을 경우에는 빈 문자열(\"\")로 출력해줘.  \n\n[설비 목록]  \n변압기, 폐유재활용설비, 송풍기, 신재생발전설비, 집진기, 펌프, 콤프레셔, 공기조화기, 열회수환기장치, 보일러, 열교환기, 배출가스처리기, 공기정화기, 탈황기, 탈질기, 오수처리기, 폐수처리기, 냉각탑, 에너지관리시스템, 공정제어시스템, 자동화시스템, 냉동기, 증기재압축장치, 폐열회수시스템, 유수분리기, 압축기, 인버터, 용해로, 응축수회수기, 악취저감설비, 사출성형기\n\n출력 예시:  \n\"인버터,용해로\"\n\n주의사항:  \n- 설비 이름은 반드시 위 목록에서만 선택해야 하며, 새로운 항목을 생성하거나 임의로 추가하지 말 것  \n- 관련성이 낮거나 판단이 어려울 경우에도 빈 문자열(\"\")로 처리할 것  \n- 출력은 항상 문자열이며, null이 아닌 빈 문자열(\"\")로 표시","hasOutputParser":true,"batching":{}},"type":"@n8n/n8n-nodes-langchain.chainLlm","typeVersion":1.7,"position":[480,60],"id":"d194ca93-1beb-44dd-8589-e899fe43ea93","name":"Basic LLM Chain1"},{"parameters":{"modelName":"models/gemini-1.5-flash-8b-latest","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[480,320],"id":"aa654a70-275d-442c-b158-7b23e10acee3","name":"Google Gemini Chat Model2","credentials":{"googlePalmApi":{"id":"XWAzclOTFyK0A6fs","name":"Google Gemini(PaLM) Api account"}}},{"parameters":{"schemaType":"manual","inputSchema":"{\n    \"$schema\": \"https://json-schema.org/draft/2020-12/schema\",\n    \"$id\": \"https://example.com/product.schema.json\",\n    \"title\": \"anouncement\",\n\t\"type\": \"object\",\n\t\"properties\": {\n      \"pblanc_nm\": {\n        \"type\": \"string\",\n        \"description\": \"공고제목\"\n      },\n      \"jrsd_instt_nm\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"대상지역\"\n      },\n      \"bsns_sumry_cn\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"공고요약\"\n      },\n      \"target_nm\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"대상기업\"\n      },\n      \"reqst_begin_end_de\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"공고전체기간\"\n      },\n      \"reqst_begin_dt\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"공고시작\"\n      },\n      \"reqst_end_dt\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"공고종료\"\n      },\n      \"reqst_mth_papers_cn\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"사업신청 방법\"\n      },\n      \"refrnc_nm\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"문의처내용\"\n      },\n      \"subsidy_amount\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"지원금액\"\n      },\n      \"bonus_points_factors\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"가점요소\"\n      },\n      \"total_budget\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"예산\"\n      },\n      \"self_contribution_rate\": {\n        \"type\": [\"string\",\"null\"],\n        \"description\": \"자부담률\"\n      },\n      \"main_category\": {\n        \"type\": \"string\",\n        \"description\": \"대분류(없으면 공백)\"\n      },\n      \"sub_category\": {\n        \"type\": \"string\",\n        \"description\": \"설비분류 (없으면 공백처리)\"\n      }\n\t},\n  \"required\": [\"pblanc_nm\"]\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[640,320],"id":"f0623310-13c9-4fb0-8a2f-ffbac6059c91","name":"Structured Output Parser","notesInFlow":false},{"parameters":{"assignments":{"assignments":[{"id":"dca754ac-4479-4295-ab21-47d895f62cae","name":"pblanc_nm","value":"={{ $('Edit Fields2').item.json.pblanc_nm }}","type":"string"},{"id":"0f927bf2-d7a7-4973-aac7-2717bed23371","name":"jrsd_instt_nm","value":"={{ $('Code').first().json.output.jrsd_instt_nm }}","type":"string"},{"id":"8d6fa575-7d4d-44d6-aaf8-9f967d478af6","name":"bsns_sumry_cn","value":"={{ $('Code').first().json.output.bsns_sumry_cn }}","type":"string"},{"id":"01a4c2d1-ab75-4e73-90a8-7bf79e5f8cd5","name":"trget_nm","value":"={{ $('Code').first().json.output.target_nm }}","type":"string"},{"id":"9507037a-7c15-4819-8357-0805d0904d7c","name":"reqst_begin_end_de","value":"={{ $('Code').first().json.output.reqst_begin_end_de }}","type":"string"},{"id":"47c24bf8-ce6b-40be-a8fd-93d8d1b03a19","name":"reqst_begin_dt","value":"={{ $('Code').first().json.output.reqst_begin_dt }}","type":"string"},{"id":"e3053a53-0200-4b96-88df-30b9bec65e62","name":"reqst_end_dt","value":"={{ $('Code').first().json.output.reqst_end_dt }}","type":"string"},{"id":"b78de255-6269-44b3-9097-50b993f40bfc","name":"refrnc_nm","value":"={{ $('Code').first().json.output.refrnc_nm }}","type":"string"},{"id":"b5e49522-9965-4e13-90b1-86edf56df9c2","name":"print_flpth_nm","value":"={{ $('Edit Fields2').item.json.print_flpth_nm }}","type":"string"},{"id":"7e662533-f931-4a90-9dfb-f1386c206c8f","name":"print_file_nm","value":"={{ $('Edit Fields2').item.json.print_file_nm }}","type":"string"},{"id":"607940df-de0c-4780-b040-d59037564076","name":"flpth_nm","value":"={{ $('Edit Fields2').item.json.flpth_nm }}","type":"string"},{"id":"1c9dd011-16d0-42d5-b17d-342b58975048","name":"file_nm","value":"={{ $('Edit Fields2').item.json.file_nm }}","type":"string"},{"id":"aff536ed-a418-4150-b586-d8f02a29010a","name":"is_classified","value":"C","type":"string"},{"id":"9f54d932-dd37-4175-b8cb-2d855891f65f","name":"subsidy_amount","value":"null","type":"object"},{"id":"8e2d8fb4-cebd-42c1-b12a-e673a77fc802","name":"self_contribution_rate","value":"null","type":"object"},{"id":"f12e819d-409d-436e-b658-684ba9ac8e30","name":"support_target","value":"null","type":"object"},{"id":"83e3ad1a-3ad2-4b72-a477-b123113b2e4a","name":"bonus_points_factors","value":"null","type":"object"},{"id":"d324fdce-53d0-453d-a211-7318d5935647","name":"total_budget","value":"null","type":"object"},{"id":"ad017264-5276-4798-91e5-7bf6f8a07b31","name":"subsidy_amount_type","value":"text","type":"string"},{"id":"0839db3e-060e-4a18-9831-915f28600652","name":"total_budget_type","value":"text","type":"string"},{"id":"75a37755-271f-4797-a2c7-cf650db294e8","name":"source","value":"={{ $('변수설정1').item.json.source }}","type":"string"},{"id":"e9fe45e7-7eff-4e79-b8f8-91e76209dc2e","name":"reqst_mth_papers_cn","value":"={{ $('Code').first().json.output.reqst_mth_papers_cn }}","type":"string"},{"id":"5cff9144-b022-4c25-820e-86ab012b1321","name":"subsidy_amount","value":"={{ $('Code').first().json.output.subsidy_amount }}","type":"string"},{"id":"576eb6a4-e3a6-4c33-812c-e9cd0823b08c","name":"self_contribution_rate","value":"={{ $('Code').first().json.output.self_contribution_rate }}","type":"string"},{"id":"43c7d965-2238-45ca-9747-6a7d29a31896","name":"support_target","value":"={{ $('Code').first().json.output.target_nm }}","type":"string"},{"id":"5b6af3c3-cb7c-4c9e-bba9-a613a8ba3825","name":"bonus_points_factors","value":"={{$('Code').first().json.output.bonus_points_factors}}","type":"string"},{"id":"3e892a8d-2f7a-4545-926c-16c4f7a624ab","name":"total_budget","value":"={{ $json.output.total_budget }}","type":"string"},{"id":"16575838-a2c6-459b-9593-77cebceffb55","name":"exc_instt_nm","value":"={{ $json.output.exc_instt_nm }}","type":"string"},{"id":"8b13bb3a-8862-4c26-9211-b1d48b8eaec2","name":"creat_p_nttm","value":"={{ $now }}","type":"string"},{"id":"a642f087-92c1-4360-9f23-8a3f3b6b6923","name":"created_ts","value":"={{ $now }}","type":"string"},{"id":"a5c8f7d9-beec-4515-ab94-7abc53bbadd4","name":"pldir_sport_realm_lclas_code_nm","value":"기술","type":"string"},{"id":"9a706910-664c-4db3-90a4-3fd551bc6216","name":"del_yn","value":"N","type":"string"},{"id":"b0eec9c4-edc4-4de9-acc3-263d761f386c","name":"hide_yn","value":"Y","type":"string"},{"id":"08e4e3d7-4053-4ebf-8ff3-b68a887f0971","name":"pblanc_url","value":"={{ $('변수설정1').item.json.base_url + $('변수설정1').item.json.board_list }}?View&boardNo={{ $json.announcement }}","type":"string"},{"id":"c0bfe37d-8c29-4d1e-be33-0faeb77cdf41","name":"main_category","value":"={{ $('Code').first().json.output.main_category }}","type":"string"},{"id":"e85ea6fe-cc25-40ff-8310-3ae146dc79dd","name":"sub_category","value":"={{ $('Code').first().json.output.sub_category }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1460,60],"id":"140761d6-d694-4691-b6f3-d32e82e423e4","name":"ai result"},{"parameters":{"rule":{"interval":[{"triggerAtHour":23,"triggerAtMinute":30}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-2780,560],"id":"65fbe1b4-4477-4320-973e-e4c6837471ee","name":"Schedule Trigger"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"2d3aee72-46af-4378-99b4-a974ed6c6c5c","leftValue":"={{ $json.pblanc_nm }}","rightValue":"","operator":{"type":"string","operation":"empty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1200,60],"id":"a881986f-86dc-4fa7-ae67-3650c240f0b4","name":"If2"},{"parameters":{"operation":"select","table":{"__rl":true,"value":"biz_info","mode":"list","cachedResultName":"biz_info"},"where":{"values":[{"column":"pblanc_nm","condition":"LIKE","value":"={{ $json.output.pblanc_nm }}"}]},"options":{}},"type":"n8n-nodes-base.mySql","typeVersion":2.4,"position":[1040,60],"id":"d7ed22dd-5264-42f1-bef4-bd97bf74f32a","name":"MySQL1","alwaysOutputData":true,"credentials":{"mySql":{"id":"HSXhV0YEF0PlSVWX","name":"MySQL account"}}},{"parameters":{"jsCode":"// Loop over input items\nfor (const item of $input.all()) {\n  // 괄호 제거\n  if (item.json.pblanc_nm) {\n    item.json.pblanc_nm = item.json.pblanc_nm.replace(/[\\(\\[][^()\\[\\]]+[\\)\\]]/g, '').trim();\n  }\n\n  // 새 필드 추가\n  item.json.myNewField = 1;\n}\n\nreturn $input.all();"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[860,60],"id":"0bc95ab1-5bec-46b9-aa2a-eba1c07bc7d8","name":"Code"},{"parameters":{"content":"사이트 주소\nhttps://www.seoultp.or.kr/user/nd19746.do?page=2","height":80,"width":700},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-2780,440],"id":"d1ed9923-4881-4b3e-8a84-49ffe6cc235f","name":"Sticky Note"},{"parameters":{"jsCode":"// Loop over input items\nfor (const item of $input.all()) {\n  // 괄호 제거\n  if (item.json.pblanc_nm) {\n    item.json.pblanc_nm = item.json.pblanc_nm.replace(/[\\(\\[][^()\\[\\]]+[\\)\\]]/g, '').trim();\n  }\n\n  // 새 필드 추가\n  item.json.myNewField = 1;\n}\n\nreturn $input.all();\n\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-720,360],"id":"5fa5fdc9-5b67-435c-afc3-b789e5edb1e1","name":"중복 자료 조회"},{"parameters":{"operation":"select","table":{"__rl":true,"value":"biz_info","mode":"list","cachedResultName":"biz_info"},"where":{"values":[{"column":"pblanc_nm","condition":"LIKE","value":"={{ $json.title }}"}]},"options":{}},"type":"n8n-nodes-base.mySql","typeVersion":2.4,"position":[-540,360],"id":"4dc32499-a995-4d86-a1d2-b07ca64c1d21","name":"중복조회 MYSQL","alwaysOutputData":true,"credentials":{"mySql":{"id":"HSXhV0YEF0PlSVWX","name":"MySQL account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"2d3aee72-46af-4378-99b4-a974ed6c6c5c","leftValue":"={{ $json.pblanc_nm }}","rightValue":"","operator":{"type":"string","operation":"empty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-380,360],"id":"14ffbaa9-3285-45bf-9ab6-0b694a71f8e9","name":"중복조회 IF"}],"connections":{"MySQL":{"main":[[{"node":"Loop Over Items2","type":"main","index":0}]]},"prepare image addr":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"do ocr1":{"main":[[{"node":"NoOp1","type":"main","index":0}]]},"board list1":{"main":[[{"node":"html extract board detail list1","type":"main","index":0}]]},"html extract board detail list1":{"main":[[{"node":"Prepare announcement1","type":"main","index":0}]]},"Prepare announcement1":{"main":[[{"node":"Loop Over Items2","type":"main","index":0}]]},"get detail1":{"main":[[{"node":"extract img list1","type":"main","index":0}]]},"extract img list1":{"main":[[{"node":"Code2","type":"main","index":0}]]},"is it today?1":{"main":[[{"node":"prepare image addr","type":"main","index":0}],[{"node":"Loop Over Items2","type":"main","index":0}]]},"get img2":{"main":[[{"node":"Upload a img1","type":"main","index":0}]]},"Upload a img1":{"main":[[{"node":"Retrieve img1","type":"main","index":0}]]},"Retrieve img1":{"main":[[{"node":"Retrieve img3","type":"main","index":0}]]},"Retrieve img3":{"main":[[{"node":"do ocr1","type":"main","index":0}]]},"get img3":{"main":[[{"node":"Upload a img1","type":"main","index":0}]]},"url starts with http or https1":{"main":[[{"node":"get img2","type":"main","index":0}],[{"node":"get img3","type":"main","index":0}]]},"NoOp1":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Loop Over Items2":{"main":[[],[{"node":"get detail1","type":"main","index":0}]]},"Loop Over Items3":{"main":[[{"node":"Summarize","type":"main","index":0}],[{"node":"url starts with http or https1","type":"main","index":0}]]},"Summarize":{"main":[[{"node":"Basic LLM Chain1","type":"main","index":0}]]},"변수설정1":{"main":[[{"node":"board list1","type":"main","index":0}]]},"Edit Fields2":{"main":[[{"node":"중복 자료 조회","type":"main","index":0}]]},"Code2":{"main":[[{"node":"Edit Fields2","type":"main","index":0}]]},"Basic LLM Chain1":{"main":[[{"node":"Code","type":"main","index":0}]]},"Google Gemini Chat Model2":{"ai_languageModel":[[{"node":"Basic LLM Chain1","type":"ai_languageModel","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Basic LLM Chain1","type":"ai_outputParser","index":0}]]},"ai result":{"main":[[{"node":"MySQL","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"변수설정1","type":"main","index":0}]]},"MySQL1":{"main":[[{"node":"If2","type":"main","index":0}]]},"Code":{"main":[[{"node":"MySQL1","type":"main","index":0}]]},"If2":{"main":[[{"node":"ai result","type":"main","index":0}],[{"node":"Loop Over Items3","type":"main","index":0}]]},"중복 자료 조회":{"main":[[{"node":"중복조회 MYSQL","type":"main","index":0}]]},"중복조회 MYSQL":{"main":[[{"node":"중복조회 IF","type":"main","index":0}]]},"중복조회 IF":{"main":[[{"node":"is it today?1","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]}},"meta":null,"pinData":{},"versionId":"4141beaf-cd7c-4467-af2f-fc332ac6d281","triggerCount":1,"shared":[{"createdAt":"2025-06-16T01:02:10.928Z","updatedAt":"2025-06-16T01:02:10.928Z","role":"workflow:owner","workflowId":"3Wwxfkf28bOQaCZP","projectId":"YGqg9zdxGQSC73yC"}],"tags":[]}